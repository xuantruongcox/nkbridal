/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ElementRef, Component, Renderer2, Input, Output, EventEmitter, ViewChild, ContentChildren, QueryList, Inject, HostListener } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { DragScrollItemDirective } from './ngx-drag-scroll-item';
var DragScrollComponent = /** @class */ (function () {
    function DragScrollComponent(_elementRef, _renderer, _document) {
        this._elementRef = _elementRef;
        this._renderer = _renderer;
        this._document = _document;
        this._index = 0;
        this._scrollbarHidden = false;
        this._disabled = false;
        this._xDisabled = false;
        this._xWheelEnabled = false;
        this._yDisabled = false;
        this._dragDisabled = false;
        this._snapDisabled = false;
        this._snapOffset = 0;
        this._snapDuration = 500;
        /**
         * Is the user currently pressing the element
         */
        this.isPressed = false;
        /**
         * Is the user currently scrolling the element
         */
        this.isScrolling = false;
        this.scrollTimer = -1;
        this.scrollToTimer = -1;
        /**
         * The x coordinates on the element
         */
        this.downX = 0;
        /**
         * The y coordinates on the element
         */
        this.downY = 0;
        this.displayType = 'block';
        this.elWidth = null;
        this.elHeight = null;
        this.scrollbarWidth = null;
        this.isAnimating = false;
        this.prevChildrenLength = 0;
        this.indexBound = 0;
        this.dsInitialized = new EventEmitter();
        this.indexChanged = new EventEmitter();
        this.reachesLeftBound = new EventEmitter();
        this.reachesRightBound = new EventEmitter();
        this.snapAnimationFinished = new EventEmitter();
        this.scrollbarWidth = this.getScrollbarWidth() + "px";
    }
    Object.defineProperty(DragScrollComponent.prototype, "currIndex", {
        get: /**
         * @return {?}
         */
        function () { return this._index; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value !== this._index) {
                this._index = value;
                this.indexChanged.emit(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "scrollbarHidden", {
        /**
         * Whether the scrollbar is hidden
         */
        get: /**
         * Whether the scrollbar is hidden
         * @return {?}
         */
        function () { return this._scrollbarHidden; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._scrollbarHidden = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "disabled", {
        /**
         * Whether horizontally and vertically draging and scrolling is be disabled
         */
        get: /**
         * Whether horizontally and vertically draging and scrolling is be disabled
         * @return {?}
         */
        function () { return this._disabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._disabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "xDisabled", {
        /**
         * Whether horizontally dragging and scrolling is be disabled
         */
        get: /**
         * Whether horizontally dragging and scrolling is be disabled
         * @return {?}
         */
        function () { return this._xDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._xDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "yDisabled", {
        /**
         * Whether vertically dragging and scrolling events is disabled
         */
        get: /**
         * Whether vertically dragging and scrolling events is disabled
         * @return {?}
         */
        function () { return this._yDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._yDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "xWheelEnabled", {
        /**
         * Whether scrolling horizontally with mouse wheel is enabled
         */
        get: /**
         * Whether scrolling horizontally with mouse wheel is enabled
         * @return {?}
         */
        function () { return this._xWheelEnabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._xWheelEnabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "dragDisabled", {
        get: /**
         * @return {?}
         */
        function () { return this._dragDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._dragDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "snapDisabled", {
        get: /**
         * @return {?}
         */
        function () { return this._snapDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._snapDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "snapOffset", {
        get: /**
         * @return {?}
         */
        function () { return this._snapOffset; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._snapOffset = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "snapDuration", {
        get: /**
         * @return {?}
         */
        function () { return this._snapDuration; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._snapDuration = value; },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngOnChanges = /**
     * @return {?}
     */
    function () {
        this.setScrollBar();
        if (this.xDisabled || this.disabled) {
            this.disableScroll('x');
        }
        else {
            this.enableScroll('x');
        }
        if (this.yDisabled || this.disabled) {
            this.disableScroll('y');
        }
        else {
            this.enableScroll('y');
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        // auto assign computed css
        this._renderer.setAttribute(this._contentRef.nativeElement, 'drag-scroll', 'true');
        this.displayType = typeof window !== 'undefined' ? window.getComputedStyle(this._elementRef.nativeElement).display : 'block';
        this._renderer.setStyle(this._contentRef.nativeElement, 'display', this.displayType);
        this._renderer.setStyle(this._contentRef.nativeElement, 'whiteSpace', 'noWrap');
        // store ele width height for later user
        this.markElDimension();
        this._renderer.setStyle(this._contentRef.nativeElement, 'width', this.elWidth);
        this._renderer.setStyle(this._contentRef.nativeElement, 'height', this.elHeight);
        if (this.wrapper) {
            this.checkScrollbar();
        }
        this._onMouseDownListener = this._renderer.listen(this._contentRef.nativeElement, 'mousedown', this.onMouseDownHandler.bind(this));
        this._onTouchStartListener = this._renderer.listen(this._contentRef.nativeElement, 'touchstart', this.onMouseDownHandler.bind(this));
        this._onScrollListener = this._renderer.listen(this._contentRef.nativeElement, 'scroll', this.onScrollHandler.bind(this));
        this._onTouchEndListener = this._renderer.listen(this._contentRef.nativeElement, 'touchend', this.onMouseUpHandler.bind(this));
        // prevent Firefox from dragging images
        this._onDragStartListener = this._renderer.listen('document', 'dragstart', (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            e.preventDefault();
        }));
        this.checkNavStatus();
        this.dsInitialized.emit();
        this.adjustMarginToLastChild();
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
        // avoid extra checks
        if (this._children['_results'].length !== this.prevChildrenLength) {
            this.markElDimension();
            this.checkScrollbar();
            this.prevChildrenLength = this._children['_results'].length;
            this.checkNavStatus();
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this._renderer.setAttribute(this._contentRef.nativeElement, 'drag-scroll', 'false');
        if (this._onMouseDownListener) {
            this._onMouseDownListener = this._onMouseDownListener();
        }
        if (this._onTouchStartListener) {
            this._onTouchStartListener = this._onTouchStartListener();
        }
        if (this._onScrollListener) {
            this._onScrollListener = this._onScrollListener();
        }
        if (this._onTouchEndListener) {
            this._onTouchEndListener = this._onTouchEndListener();
        }
        if (this._onDragStartListener) {
            this._onDragStartListener = this._onDragStartListener();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseMoveHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.onMouseMove(event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseMove = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.isPressed && !this.disabled) {
            /** @type {?} */
            var isTouchEvent = event.type === 'touchmove';
            // Workaround for prevent scroll stuck if browser lost focus
            if (!isTouchEvent) {
                /** @type {?} */
                var mouseEvent = (/** @type {?} */ (event));
                // MouseEvent.buttons not support by Safari
                // tslint:disable-next-line:deprecation
                if (!mouseEvent.buttons && !mouseEvent.which) {
                    return this.onMouseUpHandler(mouseEvent);
                }
            }
            // // Drag X
            if (!this.xDisabled && !this.dragDisabled) {
                /** @type {?} */
                var clientX = isTouchEvent ? ((/** @type {?} */ (event))).touches[0].clientX : ((/** @type {?} */ (event))).clientX;
                this._contentRef.nativeElement.scrollLeft =
                    this._contentRef.nativeElement.scrollLeft - clientX + this.downX;
                this.downX = clientX;
            }
            // Drag Y
            if (!this.yDisabled && !this.dragDisabled) {
                /** @type {?} */
                var clientY = isTouchEvent ? ((/** @type {?} */ (event))).touches[0].clientY : ((/** @type {?} */ (event))).clientY;
                this._contentRef.nativeElement.scrollTop =
                    this._contentRef.nativeElement.scrollTop - clientY + this.downY;
                this.downY = clientY;
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseDownHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var dragScrollItem = this.locateDragScrollItem((/** @type {?} */ (event.target)));
        if (dragScrollItem && dragScrollItem.dragDisabled) {
            return;
        }
        /** @type {?} */
        var isTouchEvent = event.type === 'touchstart';
        this._startGlobalListening(isTouchEvent);
        this.isPressed = true;
        if (isTouchEvent) {
            /** @type {?} */
            var touchEvent = (/** @type {?} */ (event));
            this.downX = touchEvent.touches[0].clientX;
            this.downY = touchEvent.touches[0].clientY;
        }
        else {
            /** @type {?} */
            var mouseEvent = (/** @type {?} */ (event));
            this.downX = mouseEvent.clientX;
            this.downY = mouseEvent.clientY;
        }
        clearTimeout((/** @type {?} */ (this.scrollToTimer)));
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.onScrollHandler = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.checkNavStatus();
        if (!this.isPressed && !this.isAnimating && !this.snapDisabled) {
            this.isScrolling = true;
            clearTimeout((/** @type {?} */ (this.scrollTimer)));
            this.scrollTimer = setTimeout((/**
             * @return {?}
             */
            function () {
                _this.isScrolling = false;
                _this.locateCurrentIndex(true);
            }), 500);
        }
        else {
            this.locateCurrentIndex();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseUpHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.isPressed) {
            this.isPressed = false;
            if (!this.snapDisabled) {
                this.locateCurrentIndex(true);
            }
            else {
                this.locateCurrentIndex();
            }
            this._stopGlobalListening();
        }
    };
    /*
     * Nav button
     */
    /*
       * Nav button
       */
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.moveLeft = /*
       * Nav button
       */
    /**
     * @return {?}
     */
    function () {
        if ((this.currIndex !== 0 || this.snapDisabled)) {
            this.currIndex--;
            clearTimeout((/** @type {?} */ (this.scrollToTimer)));
            this.scrollTo(this._contentRef.nativeElement, this.toChildrenLocation(), this.snapDuration);
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.moveRight = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var container = this.wrapper || this.parentNode;
        /** @type {?} */
        var containerWidth = container ? container.clientWidth : 0;
        if (!this.isScrollReachesRightEnd() && this.currIndex < this.maximumIndex(containerWidth, this._children)) {
            this.currIndex++;
            clearTimeout((/** @type {?} */ (this.scrollToTimer)));
            this.scrollTo(this._contentRef.nativeElement, this.toChildrenLocation(), this.snapDuration);
        }
    };
    /**
     * @param {?} index
     * @return {?}
     */
    DragScrollComponent.prototype.moveTo = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        /** @type {?} */
        var container = this.wrapper || this.parentNode;
        /** @type {?} */
        var containerWidth = container ? container.clientWidth : 0;
        if (index >= 0 &&
            index !== this.currIndex &&
            this.currIndex <= this.maximumIndex(containerWidth, this._children)) {
            this.currIndex = Math.min(index, this.maximumIndex(containerWidth, this._children));
            clearTimeout((/** @type {?} */ (this.scrollToTimer)));
            this.scrollTo(this._contentRef.nativeElement, this.toChildrenLocation(), this.snapDuration);
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.checkNavStatus = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var onlyOneItem = Boolean(_this._children['_results'].length <= 1);
            /** @type {?} */
            var containerIsLargerThanContent = Boolean(_this._contentRef.nativeElement.scrollWidth <=
                _this._contentRef.nativeElement.clientWidth);
            if (onlyOneItem || containerIsLargerThanContent) {
                // only one element
                _this.reachesLeftBound.emit(true);
                _this.reachesRightBound.emit(true);
            }
            else if (_this.isScrollReachesRightEnd()) {
                // reached right end
                _this.reachesLeftBound.emit(false);
                _this.reachesRightBound.emit(true);
            }
            else if (_this._contentRef.nativeElement.scrollLeft === 0 &&
                _this._contentRef.nativeElement.scrollWidth > _this._contentRef.nativeElement.clientWidth) {
                // reached left end
                _this.reachesLeftBound.emit(true);
                _this.reachesRightBound.emit(false);
            }
            else {
                // in the middle
                _this.reachesLeftBound.emit(false);
                _this.reachesRightBound.emit(false);
            }
        }), 0);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onWheel = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this._xWheelEnabled) {
            event.preventDefault();
            if (this._snapDisabled) {
                this._contentRef.nativeElement.scrollBy(event.deltaY, 0);
            }
            else {
                if (event.deltaY < 0) {
                    this.moveLeft();
                }
                else if (event.deltaY > 0) {
                    this.moveRight();
                }
            }
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.onWindowResize = /**
     * @return {?}
     */
    function () {
        this.refreshWrapperDimensions();
    };
    /**
     * @private
     * @param {?} isTouchEvent
     * @return {?}
     */
    DragScrollComponent.prototype._startGlobalListening = /**
     * @private
     * @param {?} isTouchEvent
     * @return {?}
     */
    function (isTouchEvent) {
        if (!this._onMouseMoveListener) {
            /** @type {?} */
            var eventName = isTouchEvent ? 'touchmove' : 'mousemove';
            this._onMouseMoveListener = this._renderer.listen('document', eventName, this.onMouseMoveHandler.bind(this));
        }
        if (!this._onMouseUpListener) {
            /** @type {?} */
            var eventName = isTouchEvent ? 'touchend' : 'mouseup';
            this._onMouseUpListener = this._renderer.listen('document', eventName, this.onMouseUpHandler.bind(this));
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype._stopGlobalListening = /**
     * @private
     * @return {?}
     */
    function () {
        if (this._onMouseMoveListener) {
            this._onMouseMoveListener = this._onMouseMoveListener();
        }
        if (this._onMouseUpListener) {
            this._onMouseUpListener = this._onMouseUpListener();
        }
    };
    /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    DragScrollComponent.prototype.disableScroll = /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    function (axis) {
        this._renderer.setStyle(this._contentRef.nativeElement, "overflow-" + axis, 'hidden');
    };
    /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    DragScrollComponent.prototype.enableScroll = /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    function (axis) {
        this._renderer.setStyle(this._contentRef.nativeElement, "overflow-" + axis, 'auto');
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.hideScrollbar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this._contentRef.nativeElement.style.display !== 'none' && !this.wrapper) {
            this.parentNode = this._contentRef.nativeElement.parentNode;
            // create container element
            this.wrapper = this._renderer.createElement('div');
            this._renderer.setAttribute(this.wrapper, 'class', 'drag-scroll-wrapper');
            this._renderer.addClass(this.wrapper, 'drag-scroll-container');
            this.refreshWrapperDimensions();
            this._renderer.setStyle(this.wrapper, 'overflow', 'hidden');
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', "calc(100% + " + this.scrollbarWidth + ")");
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', "calc(100% + " + this.scrollbarWidth + ")");
            // Append container element to component element.
            this._renderer.appendChild(this._elementRef.nativeElement, this.wrapper);
            // Append content element to container element.
            this._renderer.appendChild(this.wrapper, this._contentRef.nativeElement);
            this.adjustMarginToLastChild();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.showScrollbar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.wrapper) {
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', '100%');
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', this.wrapper.style.height);
            if (this.parentNode !== null) {
                this.parentNode.removeChild(this.wrapper);
                this.parentNode.appendChild(this._contentRef.nativeElement);
            }
            this.wrapper = null;
            this.adjustMarginToLastChild();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.checkScrollbar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this._contentRef.nativeElement.scrollWidth <= this._contentRef.nativeElement.clientWidth) {
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', '100%');
        }
        else {
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', "calc(100% + " + this.scrollbarWidth + ")");
        }
        if (this._contentRef.nativeElement.scrollHeight <= this._contentRef.nativeElement.clientHeight) {
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', '100%');
        }
        else {
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', "calc(100% + " + this.scrollbarWidth + ")");
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.setScrollBar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.scrollbarHidden) {
            this.hideScrollbar();
        }
        else {
            this.showScrollbar();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.getScrollbarWidth = /**
     * @private
     * @return {?}
     */
    function () {
        /**
         * Browser Scrollbar Widths (2016)
         * OSX (Chrome, Safari, Firefox) - 15px
         * Windows XP (IE7, Chrome, Firefox) - 17px
         * Windows 7 (IE10, IE11, Chrome, Firefox) - 17px
         * Windows 8.1 (IE11, Chrome, Firefox) - 17px
         * Windows 10 (IE11, Chrome, Firefox) - 17px
         * Windows 10 (Edge 12/13) - 12px
         * @type {?}
         */
        var outer = this._renderer.createElement('div');
        this._renderer.setStyle(outer, 'visibility', 'hidden');
        this._renderer.setStyle(outer, 'width', '100px');
        this._renderer.setStyle(outer, 'msOverflowStyle', 'scrollbar'); // needed for WinJS apps
        // document.body.appendChild(outer);
        this._renderer.appendChild(this._document.body, outer);
        // this._renderer.appendChild(this._renderer.selectRootElement('body'), outer);
        /** @type {?} */
        var widthNoScroll = outer.offsetWidth;
        // force scrollbars
        this._renderer.setStyle(outer, 'overflow', 'scroll');
        // add innerdiv
        /** @type {?} */
        var inner = this._renderer.createElement('div');
        this._renderer.setStyle(inner, 'width', '100%');
        this._renderer.appendChild(outer, inner);
        /** @type {?} */
        var widthWithScroll = inner.offsetWidth;
        // remove divs
        this._renderer.removeChild(this._document.body, outer);
        /**
         * Scrollbar width will be 0 on Mac OS with the
         * default "Only show scrollbars when scrolling" setting (Yosemite and up).
         * setting default width to 20;
         */
        return widthNoScroll - widthWithScroll || 20;
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.refreshWrapperDimensions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.wrapper) {
            this._renderer.setStyle(this.wrapper, 'width', '100%');
            this._renderer.setStyle(this.wrapper, 'height', this._elementRef.nativeElement.style.height
                || this._elementRef.nativeElement.offsetHeight + 'px');
        }
    };
    /*
    * The below solution is heavily inspired from
    * https://gist.github.com/andjosh/6764939
    */
    /*
      * The below solution is heavily inspired from
      * https://gist.github.com/andjosh/6764939
      */
    /**
     * @private
     * @param {?} element
     * @param {?} to
     * @param {?} duration
     * @return {?}
     */
    DragScrollComponent.prototype.scrollTo = /*
      * The below solution is heavily inspired from
      * https://gist.github.com/andjosh/6764939
      */
    /**
     * @private
     * @param {?} element
     * @param {?} to
     * @param {?} duration
     * @return {?}
     */
    function (element, to, duration) {
        /** @type {?} */
        var self = this;
        self.isAnimating = true;
        /** @type {?} */
        var start = element.scrollLeft;
        /** @type {?} */
        var change = to - start - this.snapOffset;
        /** @type {?} */
        var increment = 20;
        /** @type {?} */
        var currentTime = 0;
        // t = current time
        // b = start value
        // c = change in value
        // d = duration
        /** @type {?} */
        var easeInOutQuad = (/**
         * @param {?} t
         * @param {?} b
         * @param {?} c
         * @param {?} d
         * @return {?}
         */
        function (t, b, c, d) {
            t /= d / 2;
            if (t < 1) {
                return c / 2 * t * t + b;
            }
            t--;
            return -c / 2 * (t * (t - 2) - 1) + b;
        });
        /** @type {?} */
        var animateScroll = (/**
         * @return {?}
         */
        function () {
            currentTime += increment;
            element.scrollLeft = easeInOutQuad(currentTime, start, change, duration);
            if (currentTime < duration) {
                self.scrollToTimer = setTimeout(animateScroll, increment);
            }
            else {
                // run one more frame to make sure the animation is fully finished
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    self.isAnimating = false;
                    self.snapAnimationFinished.emit(self.currIndex);
                }), increment);
            }
        });
        animateScroll();
    };
    /**
     * @private
     * @param {?=} snap
     * @return {?}
     */
    DragScrollComponent.prototype.locateCurrentIndex = /**
     * @private
     * @param {?=} snap
     * @return {?}
     */
    function (snap) {
        var _this = this;
        this.currentChildWidth((/**
         * @param {?} currentChildWidth
         * @param {?} nextChildrenWidth
         * @param {?} childrenWidth
         * @param {?} idx
         * @param {?} stop
         * @return {?}
         */
        function (currentChildWidth, nextChildrenWidth, childrenWidth, idx, stop) {
            if ((_this._contentRef.nativeElement.scrollLeft >= childrenWidth &&
                _this._contentRef.nativeElement.scrollLeft <= nextChildrenWidth)) {
                if (nextChildrenWidth - _this._contentRef.nativeElement.scrollLeft > currentChildWidth / 2 && !_this.isScrollReachesRightEnd()) {
                    // roll back scrolling
                    if (!_this.isAnimating) {
                        _this.currIndex = idx;
                    }
                    if (snap) {
                        _this.scrollTo(_this._contentRef.nativeElement, childrenWidth, _this.snapDuration);
                    }
                }
                else {
                    // forward scrolling
                    if (!_this.isAnimating) {
                        _this.currIndex = idx + 1;
                    }
                    if (snap) {
                        _this.scrollTo(_this._contentRef.nativeElement, childrenWidth + currentChildWidth, _this.snapDuration);
                    }
                }
                stop();
            }
            else if ((idx + 1) === (_this._children['_results'].length - 1)) {
                // reaches last index
                if (!_this.isAnimating) {
                    _this.currIndex = idx + 1;
                }
                stop();
            }
        }));
    };
    /**
     * @private
     * @param {?} cb
     * @return {?}
     */
    DragScrollComponent.prototype.currentChildWidth = /**
     * @private
     * @param {?} cb
     * @return {?}
     */
    function (cb) {
        /** @type {?} */
        var childrenWidth = 0;
        /** @type {?} */
        var shouldBreak = false;
        /** @type {?} */
        var breakFunc = (/**
         * @return {?}
         */
        function () {
            shouldBreak = true;
        });
        for (var i = 0; i < this._children['_results'].length; i++) {
            if (i === this._children['_results'].length - 1) {
                break;
            }
            if (shouldBreak) {
                break;
            }
            /** @type {?} */
            var nextChildrenWidth = childrenWidth + this._children['_results'][i + 1]._elementRef.nativeElement.clientWidth;
            /** @type {?} */
            var currentClildWidth = this._children['_results'][i]._elementRef.nativeElement.clientWidth;
            cb(currentClildWidth, nextChildrenWidth, childrenWidth, i, breakFunc);
            childrenWidth += currentClildWidth;
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.toChildrenLocation = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var to = this.scrollbarHidden ? this.getScrollbarWidth() : 0;
        for (var i = 0; i < this.currIndex; i++) {
            to += this._children['_results'][i]._elementRef.nativeElement.clientWidth;
        }
        return to;
    };
    /**
     * @private
     * @param {?} element
     * @return {?}
     */
    DragScrollComponent.prototype.locateDragScrollItem = /**
     * @private
     * @param {?} element
     * @return {?}
     */
    function (element) {
        /** @type {?} */
        var item = null;
        for (var i = 0; i < this._children['_results'].length; i++) {
            if (element === this._children['_results'][i]._elementRef.nativeElement) {
                item = this._children['_results'][i];
            }
        }
        return item;
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.markElDimension = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.wrapper) {
            this.elWidth = this.wrapper.style.width;
            this.elHeight = this.wrapper.style.height;
        }
        else {
            this.elWidth = this._elementRef.nativeElement.style.width || (this._elementRef.nativeElement.offsetWidth + 'px');
            this.elHeight = this._elementRef.nativeElement.style.height || (this._elementRef.nativeElement.offsetHeight + 'px');
        }
        /** @type {?} */
        var container = this.wrapper || this.parentNode;
        /** @type {?} */
        var containerWidth = container ? container.clientWidth : 0;
        this.indexBound = this.maximumIndex(containerWidth, this._children);
    };
    /**
     * @private
     * @param {?} containerWidth
     * @param {?} childrenElements
     * @return {?}
     */
    DragScrollComponent.prototype.maximumIndex = /**
     * @private
     * @param {?} containerWidth
     * @param {?} childrenElements
     * @return {?}
     */
    function (containerWidth, childrenElements) {
        /** @type {?} */
        var count = 0;
        /** @type {?} */
        var childrenWidth = 0;
        for (var i = 0; i <= childrenElements['_results'].length; i++) {
            // last N element
            /** @type {?} */
            var dragScrollItemDirective = childrenElements['_results'][childrenElements['_results'].length - 1 - i];
            if (!dragScrollItemDirective) {
                break;
            }
            else {
                childrenWidth += dragScrollItemDirective._elementRef.nativeElement.clientWidth;
                if (childrenWidth < containerWidth) {
                    count++;
                }
                else {
                    break;
                }
            }
        }
        return childrenElements.length - count;
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.isScrollReachesRightEnd = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var scrollLeftPos = this._contentRef.nativeElement.scrollLeft + this._contentRef.nativeElement.offsetWidth;
        return scrollLeftPos >= this._contentRef.nativeElement.scrollWidth;
    };
    /**
     * adds a margin right style to the last child element which will resolve the issue
     * of last item gets cutoff.
     */
    /**
     * adds a margin right style to the last child element which will resolve the issue
     * of last item gets cutoff.
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.adjustMarginToLastChild = /**
     * adds a margin right style to the last child element which will resolve the issue
     * of last item gets cutoff.
     * @private
     * @return {?}
     */
    function () {
        if (this._children && this.hideScrollbar) {
            /** @type {?} */
            var lastItem = this._children['_results'][this._children['_results'].length - 1]._elementRef.nativeElement;
            if (this.wrapper && this._children['_results'].length > 1) {
                this._renderer.setStyle(lastItem, 'margin-right', this.scrollbarWidth);
            }
            else {
                this._renderer.setStyle(lastItem, 'margin-right', 0);
            }
        }
    };
    DragScrollComponent.decorators = [
        { type: Component, args: [{
                    selector: 'drag-scroll',
                    template: "\n    <div class=\"drag-scroll-content\" #contentRef>\n      <ng-content></ng-content>\n    </div>\n  ",
                    styles: ["\n    :host {\n      overflow: hidden;\n      display: block;\n    }\n    .drag-scroll-content {\n      height: 100%;\n      overflow: auto;\n      white-space: nowrap;\n    }\n    "]
                }] }
    ];
    /** @nocollapse */
    DragScrollComponent.ctorParameters = function () { return [
        { type: ElementRef, decorators: [{ type: Inject, args: [ElementRef,] }] },
        { type: Renderer2, decorators: [{ type: Inject, args: [Renderer2,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
    ]; };
    DragScrollComponent.propDecorators = {
        _contentRef: [{ type: ViewChild, args: ['contentRef',] }],
        _children: [{ type: ContentChildren, args: [DragScrollItemDirective,] }],
        dsInitialized: [{ type: Output }],
        indexChanged: [{ type: Output }],
        reachesLeftBound: [{ type: Output }],
        reachesRightBound: [{ type: Output }],
        snapAnimationFinished: [{ type: Output }],
        scrollbarHidden: [{ type: Input, args: ['scrollbar-hidden',] }],
        disabled: [{ type: Input, args: ['drag-scroll-disabled',] }],
        xDisabled: [{ type: Input, args: ['drag-scroll-x-disabled',] }],
        yDisabled: [{ type: Input, args: ['drag-scroll-y-disabled',] }],
        xWheelEnabled: [{ type: Input, args: ['scroll-x-wheel-enabled',] }],
        dragDisabled: [{ type: Input, args: ['drag-disabled',] }],
        snapDisabled: [{ type: Input, args: ['snap-disabled',] }],
        snapOffset: [{ type: Input, args: ['snap-offset',] }],
        snapDuration: [{ type: Input, args: ['snap-duration',] }],
        onWheel: [{ type: HostListener, args: ['wheel', ['$event'],] }],
        onWindowResize: [{ type: HostListener, args: ['window:resize',] }]
    };
    return DragScrollComponent;
}());
export { DragScrollComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._index;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._scrollbarHidden;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._disabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._xDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._xWheelEnabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._yDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._dragDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._snapDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._snapOffset;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._snapDuration;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onMouseMoveListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onMouseUpListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onMouseDownListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onTouchStartListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onScrollListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onTouchEndListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onDragStartListener;
    /**
     * Is the user currently pressing the element
     * @type {?}
     */
    DragScrollComponent.prototype.isPressed;
    /**
     * Is the user currently scrolling the element
     * @type {?}
     */
    DragScrollComponent.prototype.isScrolling;
    /** @type {?} */
    DragScrollComponent.prototype.scrollTimer;
    /** @type {?} */
    DragScrollComponent.prototype.scrollToTimer;
    /**
     * The x coordinates on the element
     * @type {?}
     */
    DragScrollComponent.prototype.downX;
    /**
     * The y coordinates on the element
     * @type {?}
     */
    DragScrollComponent.prototype.downY;
    /** @type {?} */
    DragScrollComponent.prototype.displayType;
    /** @type {?} */
    DragScrollComponent.prototype.elWidth;
    /** @type {?} */
    DragScrollComponent.prototype.elHeight;
    /**
     * The parentNode of carousel Element
     * @type {?}
     */
    DragScrollComponent.prototype.parentNode;
    /**
     * The carousel Element
     * @type {?}
     */
    DragScrollComponent.prototype._contentRef;
    /** @type {?} */
    DragScrollComponent.prototype._children;
    /** @type {?} */
    DragScrollComponent.prototype.wrapper;
    /** @type {?} */
    DragScrollComponent.prototype.scrollbarWidth;
    /** @type {?} */
    DragScrollComponent.prototype.isAnimating;
    /** @type {?} */
    DragScrollComponent.prototype.prevChildrenLength;
    /** @type {?} */
    DragScrollComponent.prototype.indexBound;
    /** @type {?} */
    DragScrollComponent.prototype.dsInitialized;
    /** @type {?} */
    DragScrollComponent.prototype.indexChanged;
    /** @type {?} */
    DragScrollComponent.prototype.reachesLeftBound;
    /** @type {?} */
    DragScrollComponent.prototype.reachesRightBound;
    /** @type {?} */
    DragScrollComponent.prototype.snapAnimationFinished;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._elementRef;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._document;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWRyYWctc2Nyb2xsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1kcmFnLXNjcm9sbC8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtZHJhZy1zY3JvbGwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0wsVUFBVSxFQUNWLFNBQVMsRUFDVCxTQUFTLEVBRVQsS0FBSyxFQUNMLE1BQU0sRUFHTixZQUFZLEVBQ1osU0FBUyxFQUNULGVBQWUsRUFFZixTQUFTLEVBQ1QsTUFBTSxFQUNOLFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFM0MsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFFakU7SUFnTEUsNkJBQzhCLFdBQXVCLEVBQ3hCLFNBQW9CLEVBQ3JCLFNBQWM7UUFGWixnQkFBVyxHQUFYLFdBQVcsQ0FBWTtRQUN4QixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3JCLGNBQVMsR0FBVCxTQUFTLENBQUs7UUEvSmxDLFdBQU0sR0FBRyxDQUFDLENBQUM7UUFFWCxxQkFBZ0IsR0FBRyxLQUFLLENBQUM7UUFFekIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUVsQixlQUFVLEdBQUcsS0FBSyxDQUFDO1FBRW5CLG1CQUFjLEdBQUcsS0FBSyxDQUFDO1FBRXZCLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFFbkIsa0JBQWEsR0FBRyxLQUFLLENBQUM7UUFFdEIsa0JBQWEsR0FBRyxLQUFLLENBQUM7UUFFdEIsZ0JBQVcsR0FBRyxDQUFDLENBQUM7UUFFaEIsa0JBQWEsR0FBRyxHQUFHLENBQUM7Ozs7UUFtQjVCLGNBQVMsR0FBRyxLQUFLLENBQUM7Ozs7UUFLbEIsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFFcEIsZ0JBQVcsR0FBMEIsQ0FBQyxDQUFDLENBQUM7UUFFeEMsa0JBQWEsR0FBMEIsQ0FBQyxD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QStCOzs7OztJQUsvQix5Q0FBd0I7Ozs7O0lBTXhCLDBDQUFpRDs7SUFFakQsd0NBQXdGOztJQUV4RixzQ0FBK0I7O0lBRS9CLDZDQUFxQzs7SUFVckMsMENBQW9COztJQUVwQixpREFBdUI7O0lBRXZCLHlDQUFlOztJQUVmLDRDQUFtRDs7SUFFbkQsMkNBQW9EOztJQUVwRCwrQ0FBeUQ7O0lBRXpELGdEQUEwRDs7SUFFMUQsb0RBQTZEOzs7OztJQXNEM0QsMENBQW1EOzs7OztJQUNuRCx3Q0FBK0M7Ozs7O0lBQy9DLHdDQUF3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEVsZW1lbnRSZWYsXG4gIENvbXBvbmVudCxcbiAgUmVuZGVyZXIyLFxuICBPbkRlc3Ryb3ksXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIEFmdGVyVmlld0luaXQsXG4gIE9uQ2hhbmdlcyxcbiAgRXZlbnRFbWl0dGVyLFxuICBWaWV3Q2hpbGQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgQWZ0ZXJWaWV3Q2hlY2tlZCxcbiAgUXVlcnlMaXN0LFxuICBJbmplY3QsXG4gIEhvc3RMaXN0ZW5lclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHsgRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfSBmcm9tICcuL25neC1kcmFnLXNjcm9sbC1pdGVtJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZHJhZy1zY3JvbGwnLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXYgY2xhc3M9XCJkcmFnLXNjcm9sbC1jb250ZW50XCIgI2NvbnRlbnRSZWY+XG4gICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgPC9kaXY+XG4gIGAsXG4gIHN0eWxlczogW2BcbiAgICA6aG9zdCB7XG4gICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgfVxuICAgIC5kcmFnLXNjcm9sbC1jb250ZW50IHtcbiAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIG92ZXJmbG93OiBhdXRvO1xuICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICB9XG4gICAgYF1cbn0pXG5leHBvcnQgY2xhc3MgRHJhZ1Njcm9sbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdDaGVja2VkIHtcbiAgcHJpdmF0ZSBfaW5kZXggPSAwO1xuXG4gIHByaXZhdGUgX3Njcm9sbGJhckhpZGRlbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX2Rpc2FibGVkID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfeERpc2FibGVkID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfeFdoZWVsRW5hYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX3lEaXNhYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX2RyYWdEaXNhYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX3NuYXBEaXNhYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX3NuYXBPZmZzZXQgPSAwO1xuXG4gIHByaXZhdGUgX3NuYXBEdXJhdGlvbiA9IDUwMDtcblxuICBwcml2YXRlIF9vbk1vdXNlTW92ZUxpc3RlbmVyOiBGdW5jdGlvbjtcblxuICBwcml2YXRlIF9vbk1vdXNlVXBMaXN0ZW5lcjogRnVuY3Rpb247XG5cbiAgcHJpdmF0ZSBfb25Nb3VzZURvd25MaXN0ZW5lcjogRnVuY3Rpb247XG5cbiAgcHJpdmF0ZSBfb25Ub3VjaFN0YXJ0TGlzdGVuZXI6IEZ1bmN0aW9uO1xuXG4gIHByaXZhdGUgX29uU2Nyb2xsTGlzdGVuZXI6IEZ1bmN0aW9uO1xuXG4gIHByaXZhdGUgX29uVG91Y2hFbmRMaXN0ZW5lcjogRnVuY3Rpb247XG5cbiAgcHJpdmF0ZSBfb25EcmFnU3RhcnRMaXN0ZW5lcjogRnVuY3Rpb247XG5cbiAgLyoqXG4gICAqIElzIHRoZSB1c2VyIGN1cnJlbnRseSBwcmVzc2luZyB0aGUgZWxlbWVudFxuICAgKi9cbiAgaXNQcmVzc2VkID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIElzIHRoZSB1c2VyIGN1cnJlbnRseSBzY3JvbGxpbmcgdGhlIGVsZW1lbnRcbiAgICovXG4gIGlzU2Nyb2xsaW5nID0gZmFsc2U7XG5cbiAgc2Nyb2xsVGltZXI6IG51bWJlciB8IE5vZGVKUy5UaW1lciA9IC0xO1xuXG4gIHNjcm9sbFRvVGltZXI6IG51bWJlciB8IE5vZGVKUy5UaW1lciA9IC0xO1xuXG4gIC8qKlxuICAgKiBUaGUgeCBjb29yZGluYXRlcyBvbiB0aGUgZWxlbWVudFxuICAgKi9cbiAgZG93blggPSAwO1xuXG4gIC8qKlxuICAgKiBUaGUgeSBjb29yZGluYXRlcyBvbiB0aGUgZWxlbWVudFxuICAgKi9cbiAgZG93blkgPSAwO1xuXG4gIGRpc3BsYXlUeXBlOiBzdHJpbmcgfCBudWxsID0gJ2Jsb2NrJztcblxuICBlbFdpZHRoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICBlbEhlaWdodDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBwYXJlbnROb2RlIG9mIGNhcm91c2VsIEVsZW1lbnRcbiAgICovXG4gIHBhcmVudE5vZGU6IEhUTUxFbGVtZW50O1xuXG4gIC8qKlxuICAgKiBUaGUgY2Fyb3VzZWwgRWxlbWVudFxuICAgKi9cblxuICBAVmlld0NoaWxkKCdjb250ZW50UmVmJykgX2NvbnRlbnRSZWY6IEVsZW1lbnRSZWY7XG5cbiAgQENvbnRlbnRDaGlsZHJlbihEcmFnU2Nyb2xsSXRlbURpcmVjdGl2ZSkgX2NoaWxkcmVuOiBRdWVyeUxpc3Q8RHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmU+O1xuXG4gIHdyYXBwZXI6IEhUTUxEaXZFbGVtZW50IHwgbnVsbDtcblxuICBzY3JvbGxiYXJXaWR0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgZ2V0IGN1cnJJbmRleCgpIHsgcmV0dXJuIHRoaXMuX2luZGV4OyB9XG4gIHNldCBjdXJySW5kZXgodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgIT09IHRoaXMuX2luZGV4KSB7XG4gICAgICB0aGlzLl9pbmRleCA9IHZhbHVlO1xuICAgICAgdGhpcy5pbmRleENoYW5nZWQuZW1pdCh2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgaXNBbmltYXRpbmcgPSBmYWxzZTtcblxuICBwcmV2Q2hpbGRyZW5MZW5ndGggPSAwO1xuXG4gIGluZGV4Qm91bmQgPSAwO1xuXG4gIEBPdXRwdXQoKSBkc0luaXRpYWxpemVkID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gIEBPdXRwdXQoKSBpbmRleENoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPG51bWJlcj4oKTtcblxuICBAT3V0cHV0KCkgcmVhY2hlc0xlZnRCb3VuZCA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcblxuICBAT3V0cHV0KCkgcmVhY2hlc1JpZ2h0Qm91bmQgPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG5cbiAgQE91dHB1dCgpIHNuYXBBbmltYXRpb25GaW5pc2hlZCA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBzY3JvbGxiYXIgaXMgaGlkZGVuXG4gICAqL1xuICBASW5wdXQoJ3Njcm9sbGJhci1oaWRkZW4nKVxuICBnZXQgc2Nyb2xsYmFySGlkZGVuKCkgeyByZXR1cm4gdGhpcy5fc2Nyb2xsYmFySGlkZGVuOyB9XG4gIHNldCBzY3JvbGxiYXJIaWRkZW4odmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5fc2Nyb2xsYmFySGlkZGVuID0gdmFsdWU7IH1cblxuICAvKipcbiAgICogV2hldGhlciBob3Jpem9udGFsbHkgYW5kIHZlcnRpY2FsbHkgZHJhZ2luZyBhbmQgc2Nyb2xsaW5nIGlzIGJlIGRpc2FibGVkXG4gICAqL1xuICBASW5wdXQoJ2RyYWctc2Nyb2xsLWRpc2FibGVkJylcbiAgZ2V0IGRpc2FibGVkKCkgeyByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7IH1cbiAgc2V0IGRpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX2Rpc2FibGVkID0gdmFsdWU7IH1cblxuICAvKipcbiAgICogV2hldGhlciBob3Jpem9udGFsbHkgZHJhZ2dpbmcgYW5kIHNjcm9sbGluZyBpcyBiZSBkaXNhYmxlZFxuICAgKi9cbiAgQElucHV0KCdkcmFnLXNjcm9sbC14LWRpc2FibGVkJylcbiAgZ2V0IHhEaXNhYmxlZCgpIHsgcmV0dXJuIHRoaXMuX3hEaXNhYmxlZDsgfVxuICBzZXQgeERpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX3hEaXNhYmxlZCA9IHZhbHVlOyB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdmVydGljYWxseSBkcmFnZ2luZyBhbmQgc2Nyb2xsaW5nIGV2ZW50cyBpcyBkaXNhYmxlZFxuICAgKi9cbiAgQElucHV0KCdkcmFnLXNjcm9sbC15LWRpc2FibGVkJylcbiAgZ2V0IHlEaXNhYmxlZCgpIHsgcmV0dXJuIHRoaXMuX3lEaXNhYmxlZDsgfVxuICBzZXQgeURpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX3lEaXNhYmxlZCA9IHZhbHVlOyB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgc2Nyb2xsaW5nIGhvcml6b250YWxseSB3aXRoIG1vdXNlIHdoZWVsIGlzIGVuYWJsZWRcbiAgICovXG4gIEBJbnB1dCgnc2Nyb2xsLXgtd2hlZWwtZW5hYmxlZCcpXG4gIGdldCB4V2hlZWxFbmFibGVkKCkgeyByZXR1cm4gdGhpcy5feFdoZWVsRW5hYmxlZDsgfVxuICBzZXQgeFdoZWVsRW5hYmxlZCh2YWx1ZTogYm9vbGVhbikgeyB0aGlzLl94V2hlZWxFbmFibGVkID0gdmFsdWU7IH1cblxuICBASW5wdXQoJ2RyYWctZGlzYWJsZWQnKVxuICBnZXQgZHJhZ0Rpc2FibGVkKCkgeyByZXR1cm4gdGhpcy5fZHJhZ0Rpc2FibGVkOyB9XG4gIHNldCBkcmFnRGlzYWJsZWQodmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5fZHJhZ0Rpc2FibGVkID0gdmFsdWU7IH1cblxuICBASW5wdXQoJ3NuYXAtZGlzYWJsZWQnKVxuICBnZXQgc25hcERpc2FibGVkKCkgeyByZXR1cm4gdGhpcy5fc25hcERpc2FibGVkOyB9XG4gIHNldCBzbmFwRGlzYWJsZWQodmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5fc25hcERpc2FibGVkID0gdmFsdWU7IH1cblxuICBASW5wdXQoJ3NuYXAtb2Zmc2V0JylcbiAgZ2V0IHNuYXBPZmZzZXQoKSB7IHJldHVybiB0aGlzLl9zbmFwT2Zmc2V0OyB9XG4gIHNldCBzbmFwT2Zmc2V0KHZhbHVlOiBudW1iZXIpIHsgdGhpcy5fc25hcE9mZnNldCA9IHZhbHVlOyB9XG5cbiAgQElucHV0KCdzbmFwLWR1cmF0aW9uJylcbiAgZ2V0IHNuYXBEdXJhdGlvbigpIHsgcmV0dXJuIHRoaXMuX3NuYXBEdXJhdGlvbjsgfVxuICBzZXQgc25hcER1cmF0aW9uKHZhbHVlOiBudW1iZXIpIHsgdGhpcy5fc25hcER1cmF0aW9uID0gdmFsdWU7IH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICBASW5qZWN0KEVsZW1lbnRSZWYpIHByaXZhdGUgX2VsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgQEluamVjdChSZW5kZXJlcjIpIHByaXZhdGUgX3JlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgQEluamVjdChET0NVTUVOVCkgcHJpdmF0ZSBfZG9jdW1lbnQ6IGFueVxuICApIHtcbiAgICB0aGlzLnNjcm9sbGJhcldpZHRoID0gYCR7dGhpcy5nZXRTY3JvbGxiYXJXaWR0aCgpfXB4YDtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIHRoaXMuc2V0U2Nyb2xsQmFyKCk7XG5cbiAgICBpZiAodGhpcy54RGlzYWJsZWQgfHwgdGhpcy5kaXNhYmxlZCkge1xuICAgICAgdGhpcy5kaXNhYmxlU2Nyb2xsKCd4Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZW5hYmxlU2Nyb2xsKCd4Jyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMueURpc2FibGVkIHx8IHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuZGlzYWJsZVNjcm9sbCgneScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVuYWJsZVNjcm9sbCgneScpO1xuICAgIH1cbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAvLyBhdXRvIGFzc2lnbiBjb21wdXRlZCBjc3NcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnZHJhZy1zY3JvbGwnLCAndHJ1ZScpO1xuXG4gICAgdGhpcy5kaXNwbGF5VHlwZSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50KS5kaXNwbGF5IDogJ2Jsb2NrJztcblxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgJ2Rpc3BsYXknLCB0aGlzLmRpc3BsYXlUeXBlKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd3aGl0ZVNwYWNlJywgJ25vV3JhcCcpO1xuXG4gICAgLy8gc3RvcmUgZWxlIHdpZHRoIGhlaWdodCBmb3IgbGF0ZXIgdXNlclxuICAgIHRoaXMubWFya0VsRGltZW5zaW9uKCk7XG5cbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIHRoaXMuZWxXaWR0aCk7XG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgdGhpcy5lbEhlaWdodCk7XG5cbiAgICBpZiAodGhpcy53cmFwcGVyKSB7XG4gICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyKCk7XG4gICAgfVxuXG4gICAgdGhpcy5fb25Nb3VzZURvd25MaXN0ZW5lciA9IHRoaXMuX3JlbmRlcmVyLmxpc3Rlbih0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdtb3VzZWRvd24nLCB0aGlzLm9uTW91c2VEb3duSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLl9vblRvdWNoU3RhcnRMaXN0ZW5lciA9IHRoaXMuX3JlbmRlcmVyLmxpc3Rlbih0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd0b3VjaHN0YXJ0JywgdGhpcy5vbk1vdXNlRG93bkhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5fb25TY3JvbGxMaXN0ZW5lciA9IHRoaXMuX3JlbmRlcmVyLmxpc3Rlbih0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdzY3JvbGwnLCB0aGlzLm9uU2Nyb2xsSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLl9vblRvdWNoRW5kTGlzdGVuZXIgPSB0aGlzLl9yZW5kZXJlci5saXN0ZW4odGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAndG91Y2hlbmQnLCB0aGlzLm9uTW91c2VVcEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgLy8gcHJldmVudCBGaXJlZm94IGZyb20gZHJhZ2dpbmcgaW1hZ2VzXG4gICAgdGhpcy5fb25EcmFnU3RhcnRMaXN0ZW5lciA9IHRoaXMuX3JlbmRlcmVyLmxpc3RlbignZG9jdW1lbnQnLCAnZHJhZ3N0YXJ0JywgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLmNoZWNrTmF2U3RhdHVzKCk7XG4gICAgdGhpcy5kc0luaXRpYWxpemVkLmVtaXQoKTtcbiAgICB0aGlzLmFkanVzdE1hcmdpblRvTGFzdENoaWxkKCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XG4gICAgLy8gYXZvaWQgZXh0cmEgY2hlY2tzXG4gICAgaWYgKHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aCAhPT0gdGhpcy5wcmV2Q2hpbGRyZW5MZW5ndGgpIHtcblxuICAgICAgdGhpcy5tYXJrRWxEaW1lbnNpb24oKTtcbiAgICAgIHRoaXMuY2hlY2tTY3JvbGxiYXIoKTtcbiAgICAgIHRoaXMucHJldkNoaWxkcmVuTGVuZ3RoID0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoO1xuICAgICAgdGhpcy5jaGVja05hdlN0YXR1cygpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldEF0dHJpYnV0ZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdkcmFnLXNjcm9sbCcsICdmYWxzZScpO1xuICAgIGlmICh0aGlzLl9vbk1vdXNlRG93bkxpc3RlbmVyKSB7XG4gICAgICB0aGlzLl9vbk1vdXNlRG93bkxpc3RlbmVyID0gdGhpcy5fb25Nb3VzZURvd25MaXN0ZW5lcigpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fb25Ub3VjaFN0YXJ0TGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuX29uVG91Y2hTdGFydExpc3RlbmVyID0gdGhpcy5fb25Ub3VjaFN0YXJ0TGlzdGVuZXIoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX29uU2Nyb2xsTGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuX29uU2Nyb2xsTGlzdGVuZXIgPSB0aGlzLl9vblNjcm9sbExpc3RlbmVyKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLl9vblRvdWNoRW5kTGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuX29uVG91Y2hFbmRMaXN0ZW5lciA9IHRoaXMuX29uVG91Y2hFbmRMaXN0ZW5lcigpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fb25EcmFnU3RhcnRMaXN0ZW5lcikge1xuICAgICAgdGhpcy5fb25EcmFnU3RhcnRMaXN0ZW5lciA9IHRoaXMuX29uRHJhZ1N0YXJ0TGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cblxuICBvbk1vdXNlTW92ZUhhbmRsZXIoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICB0aGlzLm9uTW91c2VNb3ZlKGV2ZW50KTtcbiAgfVxuXG4gIG9uTW91c2VNb3ZlKGV2ZW50OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCkge1xuICAgIGlmICh0aGlzLmlzUHJlc3NlZCAmJiAhdGhpcy5kaXNhYmxlZCkge1xuICAgICAgY29uc3QgaXNUb3VjaEV2ZW50ID0gZXZlbnQudHlwZSA9PT0gJ3RvdWNobW92ZSc7XG5cbiAgICAgIC8vIFdvcmthcm91bmQgZm9yIHByZXZlbnQgc2Nyb2xsIHN0dWNrIGlmIGJyb3dzZXIgbG9zdCBmb2N1c1xuICAgICAgaWYgKCFpc1RvdWNoRXZlbnQpIHtcbiAgICAgICAgY29uc3QgbW91c2VFdmVudCA9IGV2ZW50IGFzIE1vdXNlRXZlbnQ7XG4gICAgICAgIC8vIE1vdXNlRXZlbnQuYnV0dG9ucyBub3Qgc3VwcG9ydCBieSBTYWZhcmlcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRlcHJlY2F0aW9uXG4gICAgICAgIGlmICghbW91c2VFdmVudC5idXR0b25zICYmICFtb3VzZUV2ZW50LndoaWNoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMub25Nb3VzZVVwSGFuZGxlcihtb3VzZUV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyAvLyBEcmFnIFhcbiAgICAgIGlmICghdGhpcy54RGlzYWJsZWQgJiYgIXRoaXMuZHJhZ0Rpc2FibGVkKSB7XG4gICAgICAgIGNvbnN0IGNsaWVudFggPSBpc1RvdWNoRXZlbnQgPyAoZXZlbnQgYXMgVG91Y2hFdmVudCkudG91Y2hlc1swXS5jbGllbnRYIDogKGV2ZW50IGFzIE1vdXNlRXZlbnQpLmNsaWVudFg7XG4gICAgICAgIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID1cbiAgICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCAtIGNsaWVudFggKyB0aGlzLmRvd25YO1xuICAgICAgICB0aGlzLmRvd25YID0gY2xpZW50WDtcbiAgICAgIH1cblxuICAgICAgLy8gRHJhZyBZXG4gICAgICBpZiAoIXRoaXMueURpc2FibGVkICYmICF0aGlzLmRyYWdEaXNhYmxlZCkge1xuICAgICAgICBjb25zdCBjbGllbnRZID0gaXNUb3VjaEV2ZW50ID8gKGV2ZW50IGFzIFRvdWNoRXZlbnQpLnRvdWNoZXNbMF0uY2xpZW50WSA6IChldmVudCBhcyBNb3VzZUV2ZW50KS5jbGllbnRZO1xuICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID1cbiAgICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wIC0gY2xpZW50WSArIHRoaXMuZG93blk7XG4gICAgICAgIHRoaXMuZG93blkgPSBjbGllbnRZO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG9uTW91c2VEb3duSGFuZGxlcihldmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpIHtcbiAgICBjb25zdCBkcmFnU2Nyb2xsSXRlbTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfCBudWxsID0gdGhpcy5sb2NhdGVEcmFnU2Nyb2xsSXRlbShldmVudC50YXJnZXQgYXMgRWxlbWVudCk7XG4gICAgaWYgKGRyYWdTY3JvbGxJdGVtICYmIGRyYWdTY3JvbGxJdGVtLmRyYWdEaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGlzVG91Y2hFdmVudCA9IGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0JztcblxuICAgIHRoaXMuX3N0YXJ0R2xvYmFsTGlzdGVuaW5nKGlzVG91Y2hFdmVudCk7XG4gICAgdGhpcy5pc1ByZXNzZWQgPSB0cnVlO1xuXG4gICAgaWYgKGlzVG91Y2hFdmVudCkge1xuICAgICAgY29uc3QgdG91Y2hFdmVudCA9IGV2ZW50IGFzIFRvdWNoRXZlbnQ7XG4gICAgICB0aGlzLmRvd25YID0gdG91Y2hFdmVudC50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICB0aGlzLmRvd25ZID0gdG91Y2hFdmVudC50b3VjaGVzWzBdLmNsaWVudFk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG1vdXNlRXZlbnQgPSBldmVudCBhcyBNb3VzZUV2ZW50O1xuICAgICAgdGhpcy5kb3duWCA9IG1vdXNlRXZlbnQuY2xpZW50WDtcbiAgICAgIHRoaXMuZG93blkgPSBtb3VzZUV2ZW50LmNsaWVudFk7XG4gICAgfVxuXG5cbiAgICBjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxUb1RpbWVyIGFzIG51bWJlcik7XG4gIH1cblxuICBvblNjcm9sbEhhbmRsZXIoKSB7XG4gICAgdGhpcy5jaGVja05hdlN0YXR1cygpO1xuICAgIGlmICghdGhpcy5pc1ByZXNzZWQgJiYgIXRoaXMuaXNBbmltYXRpbmcgJiYgIXRoaXMuc25hcERpc2FibGVkKSB7XG4gICAgICB0aGlzLmlzU2Nyb2xsaW5nID0gdHJ1ZTtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNjcm9sbFRpbWVyIGFzIG51bWJlcik7XG4gICAgICB0aGlzLnNjcm9sbFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuaXNTY3JvbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sb2NhdGVDdXJyZW50SW5kZXgodHJ1ZSk7XG4gICAgICB9LCA1MDApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvY2F0ZUN1cnJlbnRJbmRleCgpO1xuICAgIH1cbiAgfVxuXG4gIG9uTW91c2VVcEhhbmRsZXIoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBpZiAodGhpcy5pc1ByZXNzZWQpIHtcbiAgICAgIHRoaXMuaXNQcmVzc2VkID0gZmFsc2U7XG4gICAgICBpZiAoIXRoaXMuc25hcERpc2FibGVkKSB7XG4gICAgICAgIHRoaXMubG9jYXRlQ3VycmVudEluZGV4KHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sb2NhdGVDdXJyZW50SW5kZXgoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3N0b3BHbG9iYWxMaXN0ZW5pbmcoKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBOYXYgYnV0dG9uXG4gICAqL1xuICBtb3ZlTGVmdCgpIHtcbiAgICBpZiAoKHRoaXMuY3VyckluZGV4ICE9PSAwIHx8IHRoaXMuc25hcERpc2FibGVkKSkge1xuICAgICAgdGhpcy5jdXJySW5kZXgtLTtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNjcm9sbFRvVGltZXIgYXMgbnVtYmVyKTtcbiAgICAgIHRoaXMuc2Nyb2xsVG8odGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCB0aGlzLnRvQ2hpbGRyZW5Mb2NhdGlvbigpLCB0aGlzLnNuYXBEdXJhdGlvbik7XG4gICAgfVxuICB9XG5cbiAgbW92ZVJpZ2h0KCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMud3JhcHBlciB8fCB0aGlzLnBhcmVudE5vZGU7XG4gICAgY29uc3QgY29udGFpbmVyV2lkdGggPSBjb250YWluZXIgPyBjb250YWluZXIuY2xpZW50V2lkdGggOiAwO1xuXG4gICAgaWYgKCF0aGlzLmlzU2Nyb2xsUmVhY2hlc1JpZ2h0RW5kKCkgJiYgdGhpcy5jdXJySW5kZXggPCB0aGlzLm1heGltdW1JbmRleChjb250YWluZXJXaWR0aCwgdGhpcy5fY2hpbGRyZW4pKSB7XG4gICAgICB0aGlzLmN1cnJJbmRleCsrO1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2Nyb2xsVG9UaW1lciBhcyBudW1iZXIpO1xuICAgICAgdGhpcy5zY3JvbGxUbyh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsIHRoaXMudG9DaGlsZHJlbkxvY2F0aW9uKCksIHRoaXMuc25hcER1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICBtb3ZlVG8oaW5kZXg6IG51bWJlcikge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMud3JhcHBlciB8fCB0aGlzLnBhcmVudE5vZGU7XG4gICAgY29uc3QgY29udGFpbmVyV2lkdGggPSBjb250YWluZXIgPyBjb250YWluZXIuY2xpZW50V2lkdGggOiAwO1xuICAgIGlmIChcbiAgICAgIGluZGV4ID49IDAgJiZcbiAgICAgIGluZGV4ICE9PSB0aGlzLmN1cnJJbmRleCAmJlxuICAgICAgdGhpcy5jdXJySW5kZXggPD0gdGhpcy5tYXhpbXVtSW5kZXgoY29udGFpbmVyV2lkdGgsIHRoaXMuX2NoaWxkcmVuKVxuICAgICkge1xuICAgICAgdGhpcy5jdXJySW5kZXggPSBNYXRoLm1pbihpbmRleCwgdGhpcy5tYXhpbXVtSW5kZXgoY29udGFpbmVyV2lkdGgsIHRoaXMuX2NoaWxkcmVuKSk7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxUb1RpbWVyIGFzIG51bWJlcik7XG4gICAgICB0aGlzLnNjcm9sbFRvKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgdGhpcy50b0NoaWxkcmVuTG9jYXRpb24oKSwgdGhpcy5zbmFwRHVyYXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIGNoZWNrTmF2U3RhdHVzKCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgY29uc3Qgb25seU9uZUl0ZW0gPSBCb29sZWFuKHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aCA8PSAxKTtcbiAgICAgIGNvbnN0IGNvbnRhaW5lcklzTGFyZ2VyVGhhbkNvbnRlbnQgPSBCb29sZWFuKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxXaWR0aCA8PVxuICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGgpO1xuICAgICAgaWYgKG9ubHlPbmVJdGVtIHx8IGNvbnRhaW5lcklzTGFyZ2VyVGhhbkNvbnRlbnQpIHtcbiAgICAgICAgLy8gb25seSBvbmUgZWxlbWVudFxuICAgICAgICB0aGlzLnJlYWNoZXNMZWZ0Qm91bmQuZW1pdCh0cnVlKTtcbiAgICAgICAgdGhpcy5yZWFjaGVzUmlnaHRCb3VuZC5lbWl0KHRydWUpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlzU2Nyb2xsUmVhY2hlc1JpZ2h0RW5kKCkpIHtcbiAgICAgICAgLy8gcmVhY2hlZCByaWdodCBlbmRcbiAgICAgICAgdGhpcy5yZWFjaGVzTGVmdEJvdW5kLmVtaXQoZmFsc2UpO1xuICAgICAgICB0aGlzLnJlYWNoZXNSaWdodEJvdW5kLmVtaXQodHJ1ZSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID09PSAwICYmXG4gICAgICAgIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxXaWR0aCA+IHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aCkge1xuICAgICAgICAvLyByZWFjaGVkIGxlZnQgZW5kXG4gICAgICAgIHRoaXMucmVhY2hlc0xlZnRCb3VuZC5lbWl0KHRydWUpO1xuICAgICAgICB0aGlzLnJlYWNoZXNSaWdodEJvdW5kLmVtaXQoZmFsc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaW4gdGhlIG1pZGRsZVxuICAgICAgICB0aGlzLnJlYWNoZXNMZWZ0Qm91bmQuZW1pdChmYWxzZSk7XG4gICAgICAgIHRoaXMucmVhY2hlc1JpZ2h0Qm91bmQuZW1pdChmYWxzZSk7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCd3aGVlbCcsIFsnJGV2ZW50J10pXG4gIHB1YmxpYyBvbldoZWVsKGV2ZW50OiBXaGVlbEV2ZW50KSB7XG4gICAgaWYgKHRoaXMuX3hXaGVlbEVuYWJsZWQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGlmICh0aGlzLl9zbmFwRGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbEJ5KGV2ZW50LmRlbHRhWSwgMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZXZlbnQuZGVsdGFZIDwgMCkge1xuICAgICAgICAgIHRoaXMubW92ZUxlZnQoKTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5kZWx0YVkgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tb3ZlUmlnaHQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpyZXNpemUnKVxuICBwdWJsaWMgb25XaW5kb3dSZXNpemUoKSB7XG4gICAgdGhpcy5yZWZyZXNoV3JhcHBlckRpbWVuc2lvbnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgX3N0YXJ0R2xvYmFsTGlzdGVuaW5nKGlzVG91Y2hFdmVudDogYm9vbGVhbikge1xuICAgIGlmICghdGhpcy5fb25Nb3VzZU1vdmVMaXN0ZW5lcikge1xuICAgICAgY29uc3QgZXZlbnROYW1lID0gaXNUb3VjaEV2ZW50ID8gJ3RvdWNobW92ZScgOiAnbW91c2Vtb3ZlJztcbiAgICAgIHRoaXMuX29uTW91c2VNb3ZlTGlzdGVuZXIgPSB0aGlzLl9yZW5kZXJlci5saXN0ZW4oJ2RvY3VtZW50JywgZXZlbnROYW1lLCB0aGlzLm9uTW91c2VNb3ZlSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX29uTW91c2VVcExpc3RlbmVyKSB7XG4gICAgICBjb25zdCBldmVudE5hbWUgPSBpc1RvdWNoRXZlbnQgPyAndG91Y2hlbmQnIDogJ21vdXNldXAnO1xuICAgICAgdGhpcy5fb25Nb3VzZVVwTGlzdGVuZXIgPSB0aGlzLl9yZW5kZXJlci5saXN0ZW4oJ2RvY3VtZW50JywgZXZlbnROYW1lLCB0aGlzLm9uTW91c2VVcEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfc3RvcEdsb2JhbExpc3RlbmluZygpIHtcbiAgICBpZiAodGhpcy5fb25Nb3VzZU1vdmVMaXN0ZW5lcikge1xuICAgICAgdGhpcy5fb25Nb3VzZU1vdmVMaXN0ZW5lciA9IHRoaXMuX29uTW91c2VNb3ZlTGlzdGVuZXIoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fb25Nb3VzZVVwTGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuX29uTW91c2VVcExpc3RlbmVyID0gdGhpcy5fb25Nb3VzZVVwTGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRpc2FibGVTY3JvbGwoYXhpczogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCBgb3ZlcmZsb3ctJHtheGlzfWAsICdoaWRkZW4nKTtcbiAgfVxuXG4gIHByaXZhdGUgZW5hYmxlU2Nyb2xsKGF4aXM6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgYG92ZXJmbG93LSR7YXhpc31gLCAnYXV0bycpO1xuICB9XG5cbiAgcHJpdmF0ZSBoaWRlU2Nyb2xsYmFyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnICYmICF0aGlzLndyYXBwZXIpIHtcbiAgICAgIHRoaXMucGFyZW50Tm9kZSA9IHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5wYXJlbnROb2RlO1xuXG4gICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGVsZW1lbnRcbiAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuX3JlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMud3JhcHBlciwgJ2NsYXNzJywgJ2RyYWctc2Nyb2xsLXdyYXBwZXInKTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlciwgJ2RyYWctc2Nyb2xsLWNvbnRhaW5lcicpO1xuXG4gICAgICB0aGlzLnJlZnJlc2hXcmFwcGVyRGltZW5zaW9ucygpO1xuXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLndyYXBwZXIsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcblxuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCBgY2FsYygxMDAlICsgJHt0aGlzLnNjcm9sbGJhcldpZHRofSlgKTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsIGBjYWxjKDEwMCUgKyAke3RoaXMuc2Nyb2xsYmFyV2lkdGh9KWApO1xuXG4gICAgICAvLyBBcHBlbmQgY29udGFpbmVyIGVsZW1lbnQgdG8gY29tcG9uZW50IGVsZW1lbnQuXG4gICAgICB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsIHRoaXMud3JhcHBlcik7XG5cbiAgICAgIC8vIEFwcGVuZCBjb250ZW50IGVsZW1lbnQgdG8gY29udGFpbmVyIGVsZW1lbnQuXG4gICAgICB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLndyYXBwZXIsIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgIHRoaXMuYWRqdXN0TWFyZ2luVG9MYXN0Q2hpbGQoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNob3dTY3JvbGxiYXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMud3JhcHBlcikge1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCAnMTAwJScpO1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgdGhpcy53cmFwcGVyLnN0eWxlLmhlaWdodCk7XG4gICAgICBpZiAodGhpcy5wYXJlbnROb2RlICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLndyYXBwZXIpO1xuICAgICAgICB0aGlzLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50KTtcbiAgICAgIH1cbiAgICAgIHRoaXMud3JhcHBlciA9IG51bGw7XG5cbiAgICAgIHRoaXMuYWRqdXN0TWFyZ2luVG9MYXN0Q2hpbGQoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNoZWNrU2Nyb2xsYmFyKCkge1xuICAgIGlmICh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGggPD0gdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoKSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCAnMTAwJScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCBgY2FsYygxMDAlICsgJHt0aGlzLnNjcm9sbGJhcldpZHRofSlgKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxIZWlnaHQgPD0gdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodCkge1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCAnMTAwJScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIGBjYWxjKDEwMCUgKyAke3RoaXMuc2Nyb2xsYmFyV2lkdGh9KWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0U2Nyb2xsQmFyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNjcm9sbGJhckhpZGRlbikge1xuICAgICAgdGhpcy5oaWRlU2Nyb2xsYmFyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2hvd1Njcm9sbGJhcigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0U2Nyb2xsYmFyV2lkdGgoKTogbnVtYmVyIHtcbiAgICAvKipcbiAgICAgKiBCcm93c2VyIFNjcm9sbGJhciBXaWR0aHMgKDIwMTYpXG4gICAgICogT1NYIChDaHJvbWUsIFNhZmFyaSwgRmlyZWZveCkgLSAxNXB4XG4gICAgICogV2luZG93cyBYUCAoSUU3LCBDaHJvbWUsIEZpcmVmb3gpIC0gMTdweFxuICAgICAqIFdpbmRvd3MgNyAoSUUxMCwgSUUxMSwgQ2hyb21lLCBGaXJlZm94KSAtIDE3cHhcbiAgICAgKiBXaW5kb3dzIDguMSAoSUUxMSwgQ2hyb21lLCBGaXJlZm94KSAtIDE3cHhcbiAgICAgKiBXaW5kb3dzIDEwIChJRTExLCBDaHJvbWUsIEZpcmVmb3gpIC0gMTdweFxuICAgICAqIFdpbmRvd3MgMTAgKEVkZ2UgMTIvMTMpIC0gMTJweFxuICAgICAqL1xuICAgIGNvbnN0IG91dGVyID0gdGhpcy5fcmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUob3V0ZXIsICd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKG91dGVyLCAnd2lkdGgnLCAnMTAwcHgnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShvdXRlciwgJ21zT3ZlcmZsb3dTdHlsZScsICdzY3JvbGxiYXInKTsgIC8vIG5lZWRlZCBmb3IgV2luSlMgYXBwc1xuICAgIC8vIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3V0ZXIpO1xuICAgIHRoaXMuX3JlbmRlcmVyLmFwcGVuZENoaWxkKHRoaXMuX2RvY3VtZW50LmJvZHksIG91dGVyKTtcbiAgICAvLyB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLl9yZW5kZXJlci5zZWxlY3RSb290RWxlbWVudCgnYm9keScpLCBvdXRlcik7XG4gICAgY29uc3Qgd2lkdGhOb1Njcm9sbCA9IG91dGVyLm9mZnNldFdpZHRoO1xuICAgIC8vIGZvcmNlIHNjcm9sbGJhcnNcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShvdXRlciwgJ292ZXJmbG93JywgJ3Njcm9sbCcpO1xuXG4gICAgLy8gYWRkIGlubmVyZGl2XG4gICAgY29uc3QgaW5uZXIgPSB0aGlzLl9yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShpbm5lciwgJ3dpZHRoJywgJzEwMCUnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZChvdXRlciwgaW5uZXIpO1xuXG4gICAgY29uc3Qgd2lkdGhXaXRoU2Nyb2xsID0gaW5uZXIub2Zmc2V0V2lkdGg7XG5cbiAgICAvLyByZW1vdmUgZGl2c1xuICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNoaWxkKHRoaXMuX2RvY3VtZW50LmJvZHksIG91dGVyKTtcblxuICAgIC8qKlxuICAgICAqIFNjcm9sbGJhciB3aWR0aCB3aWxsIGJlIDAgb24gTWFjIE9TIHdpdGggdGhlXG4gICAgICogZGVmYXVsdCBcIk9ubHkgc2hvdyBzY3JvbGxiYXJzIHdoZW4gc2Nyb2xsaW5nXCIgc2V0dGluZyAoWW9zZW1pdGUgYW5kIHVwKS5cbiAgICAgKiBzZXR0aW5nIGRlZmF1bHQgd2lkdGggdG8gMjA7XG4gICAgICovXG4gICAgcmV0dXJuIHdpZHRoTm9TY3JvbGwgLSB3aWR0aFdpdGhTY3JvbGwgfHwgMjA7XG4gIH1cblxuICBwcml2YXRlIHJlZnJlc2hXcmFwcGVyRGltZW5zaW9ucygpIHtcbiAgICBpZiAodGhpcy53cmFwcGVyKSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLndyYXBwZXIsICd3aWR0aCcsICcxMDAlJyk7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLndyYXBwZXIsICdoZWlnaHQnLCB0aGlzLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0XG4gICAgICAgIHx8IHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAqIFRoZSBiZWxvdyBzb2x1dGlvbiBpcyBoZWF2aWx5IGluc3BpcmVkIGZyb21cbiAgKiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9hbmRqb3NoLzY3NjQ5MzlcbiAgKi9cbiAgcHJpdmF0ZSBzY3JvbGxUbyhlbGVtZW50OiBFbGVtZW50LCB0bzogbnVtYmVyLCBkdXJhdGlvbjogbnVtYmVyKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5pc0FuaW1hdGluZyA9IHRydWU7XG4gICAgY29uc3Qgc3RhcnQgPSBlbGVtZW50LnNjcm9sbExlZnQsXG4gICAgICBjaGFuZ2UgPSB0byAtIHN0YXJ0IC0gdGhpcy5zbmFwT2Zmc2V0LFxuICAgICAgaW5jcmVtZW50ID0gMjA7XG4gICAgbGV0IGN1cnJlbnRUaW1lID0gMDtcblxuICAgIC8vIHQgPSBjdXJyZW50IHRpbWVcbiAgICAvLyBiID0gc3RhcnQgdmFsdWVcbiAgICAvLyBjID0gY2hhbmdlIGluIHZhbHVlXG4gICAgLy8gZCA9IGR1cmF0aW9uXG4gICAgY29uc3QgZWFzZUluT3V0UXVhZCA9IGZ1bmN0aW9uICh0OiBudW1iZXIsIGI6IG51bWJlciwgYzogbnVtYmVyLCBkOiBudW1iZXIpIHtcbiAgICAgIHQgLz0gZCAvIDI7XG4gICAgICBpZiAodCA8IDEpIHtcbiAgICAgICAgcmV0dXJuIGMgLyAyICogdCAqIHQgKyBiO1xuICAgICAgfVxuICAgICAgdC0tO1xuICAgICAgcmV0dXJuIC1jIC8gMiAqICh0ICogKHQgLSAyKSAtIDEpICsgYjtcbiAgICB9O1xuXG4gICAgY29uc3QgYW5pbWF0ZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGN1cnJlbnRUaW1lICs9IGluY3JlbWVudDtcbiAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCA9IGVhc2VJbk91dFF1YWQoY3VycmVudFRpbWUsIHN0YXJ0LCBjaGFuZ2UsIGR1cmF0aW9uKTtcbiAgICAgIGlmIChjdXJyZW50VGltZSA8IGR1cmF0aW9uKSB7XG4gICAgICAgIHNlbGYuc2Nyb2xsVG9UaW1lciA9IHNldFRpbWVvdXQoYW5pbWF0ZVNjcm9sbCwgaW5jcmVtZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHJ1biBvbmUgbW9yZSBmcmFtZSB0byBtYWtlIHN1cmUgdGhlIGFuaW1hdGlvbiBpcyBmdWxseSBmaW5pc2hlZFxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBzZWxmLmlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgc2VsZi5zbmFwQW5pbWF0aW9uRmluaXNoZWQuZW1pdChzZWxmLmN1cnJJbmRleCk7XG4gICAgICAgIH0sIGluY3JlbWVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBhbmltYXRlU2Nyb2xsKCk7XG4gIH1cblxuICBwcml2YXRlIGxvY2F0ZUN1cnJlbnRJbmRleChzbmFwPzogYm9vbGVhbikge1xuICAgIHRoaXMuY3VycmVudENoaWxkV2lkdGgoKGN1cnJlbnRDaGlsZFdpZHRoLCBuZXh0Q2hpbGRyZW5XaWR0aCwgY2hpbGRyZW5XaWR0aCwgaWR4OiBudW1iZXIsIHN0b3ApID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID49IGNoaWxkcmVuV2lkdGggJiZcbiAgICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCA8PSBuZXh0Q2hpbGRyZW5XaWR0aClcbiAgICAgICkge1xuICAgICAgICBpZiAobmV4dENoaWxkcmVuV2lkdGggLSB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCA+IGN1cnJlbnRDaGlsZFdpZHRoIC8gMiAmJiAhdGhpcy5pc1Njcm9sbFJlYWNoZXNSaWdodEVuZCgpKSB7XG4gICAgICAgICAgLy8gcm9sbCBiYWNrIHNjcm9sbGluZ1xuICAgICAgICAgIGlmICghdGhpcy5pc0FuaW1hdGluZykge1xuICAgICAgICAgICAgdGhpcy5jdXJySW5kZXggPSBpZHg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzbmFwKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgY2hpbGRyZW5XaWR0aCwgdGhpcy5zbmFwRHVyYXRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBmb3J3YXJkIHNjcm9sbGluZ1xuICAgICAgICAgIGlmICghdGhpcy5pc0FuaW1hdGluZykge1xuICAgICAgICAgICAgdGhpcy5jdXJySW5kZXggPSBpZHggKyAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoc25hcCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUbyh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsIGNoaWxkcmVuV2lkdGggKyBjdXJyZW50Q2hpbGRXaWR0aCwgdGhpcy5zbmFwRHVyYXRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdG9wKCk7XG4gICAgICB9IGVsc2UgaWYgKChpZHggKyAxKSA9PT0gKHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgIC8vIHJlYWNoZXMgbGFzdCBpbmRleFxuICAgICAgICBpZiAoIXRoaXMuaXNBbmltYXRpbmcpIHtcbiAgICAgICAgICB0aGlzLmN1cnJJbmRleCA9IGlkeCArIDE7XG4gICAgICAgIH1cbiAgICAgICAgc3RvcCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBjdXJyZW50Q2hpbGRXaWR0aChjYjogKFxuICAgIGN1cnJlbnRDbGlsZFdpZHRoOiBudW1iZXIsXG4gICAgbmV4dENoaWxkcmVuV2lkdGg6IG51bWJlcixcbiAgICBjaGlsZHJlbldpZHRoOiBudW1iZXIsXG4gICAgaW5kZXg6IG51bWJlcixcbiAgICBicmVha0Z1bmM6ICgpID0+IHZvaWQpID0+IHZvaWQpIHtcbiAgICBsZXQgY2hpbGRyZW5XaWR0aCA9IDA7XG4gICAgbGV0IHNob3VsZEJyZWFrID0gZmFsc2U7XG4gICAgY29uc3QgYnJlYWtGdW5jID0gZnVuY3Rpb24gKCkge1xuICAgICAgc2hvdWxkQnJlYWsgPSB0cnVlO1xuICAgIH07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9jaGlsZHJlblsnX3Jlc3VsdHMnXS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGkgPT09IHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoc2hvdWxkQnJlYWspIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG5leHRDaGlsZHJlbldpZHRoID0gY2hpbGRyZW5XaWR0aCArIHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddW2kgKyAxXS5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgICAgY29uc3QgY3VycmVudENsaWxkV2lkdGggPSB0aGlzLl9jaGlsZHJlblsnX3Jlc3VsdHMnXVtpXS5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgICAgY2IoY3VycmVudENsaWxkV2lkdGgsIG5leHRDaGlsZHJlbldpZHRoLCBjaGlsZHJlbldpZHRoLCBpLCBicmVha0Z1bmMpO1xuXG4gICAgICBjaGlsZHJlbldpZHRoICs9IGN1cnJlbnRDbGlsZFdpZHRoO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdG9DaGlsZHJlbkxvY2F0aW9uKCk6IG51bWJlciB7XG4gICAgbGV0IHRvID0gdGhpcy5zY3JvbGxiYXJIaWRkZW4gPyB0aGlzLmdldFNjcm9sbGJhcldpZHRoKCkgOiAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jdXJySW5kZXg7IGkrKykge1xuICAgICAgdG8gKz0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baV0uX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICB9XG4gICAgcmV0dXJuIHRvO1xuICB9XG5cbiAgcHJpdmF0ZSBsb2NhdGVEcmFnU2Nyb2xsSXRlbShlbGVtZW50OiBFbGVtZW50KTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfCBudWxsIHtcbiAgICBsZXQgaXRlbTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfCBudWxsID0gbnVsbDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoZWxlbWVudCA9PT0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baV0uX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudCkge1xuICAgICAgICBpdGVtID0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpdGVtO1xuICB9XG5cbiAgcHJpdmF0ZSBtYXJrRWxEaW1lbnNpb24oKSB7XG4gICAgaWYgKHRoaXMud3JhcHBlcikge1xuICAgICAgdGhpcy5lbFdpZHRoID0gdGhpcy53cmFwcGVyLnN0eWxlLndpZHRoO1xuICAgICAgdGhpcy5lbEhlaWdodCA9IHRoaXMud3JhcHBlci5zdHlsZS5oZWlnaHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxXaWR0aCA9IHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS53aWR0aCB8fCAodGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoICsgJ3B4Jyk7XG4gICAgICB0aGlzLmVsSGVpZ2h0ID0gdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCB8fCAodGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodCArICdweCcpO1xuICAgIH1cbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLndyYXBwZXIgfHwgdGhpcy5wYXJlbnROb2RlO1xuICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gY29udGFpbmVyID8gY29udGFpbmVyLmNsaWVudFdpZHRoIDogMDtcbiAgICB0aGlzLmluZGV4Qm91bmQgPSAgdGhpcy5tYXhpbXVtSW5kZXgoY29udGFpbmVyV2lkdGgsIHRoaXMuX2NoaWxkcmVuKTtcbiAgfVxuXG4gIHByaXZhdGUgbWF4aW11bUluZGV4KGNvbnRhaW5lcldpZHRoOiBudW1iZXIsIGNoaWxkcmVuRWxlbWVudHM6IFF1ZXJ5TGlzdDxEcmFnU2Nyb2xsSXRlbURpcmVjdGl2ZT4pOiBudW1iZXIge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgbGV0IGNoaWxkcmVuV2lkdGggPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGNoaWxkcmVuRWxlbWVudHNbJ19yZXN1bHRzJ10ubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIGxhc3QgTiBlbGVtZW50XG4gICAgICBjb25zdCBkcmFnU2Nyb2xsSXRlbURpcmVjdGl2ZTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgPSBjaGlsZHJlbkVsZW1lbnRzWydfcmVzdWx0cyddW2NoaWxkcmVuRWxlbWVudHNbJ19yZXN1bHRzJ10ubGVuZ3RoIC0gMSAtIGldO1xuICAgICAgaWYgKCFkcmFnU2Nyb2xsSXRlbURpcmVjdGl2ZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkcmVuV2lkdGggKz0gZHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICAgICAgaWYgKGNoaWxkcmVuV2lkdGggPCBjb250YWluZXJXaWR0aCkge1xuICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNoaWxkcmVuRWxlbWVudHMubGVuZ3RoIC0gY291bnQ7XG4gIH1cblxuICBwcml2YXRlIGlzU2Nyb2xsUmVhY2hlc1JpZ2h0RW5kKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHNjcm9sbExlZnRQb3MgPSB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCArIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICByZXR1cm4gc2Nyb2xsTGVmdFBvcyA+PSB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGg7XG4gIH1cblxuICAvKipcbiAgICogYWRkcyBhIG1hcmdpbiByaWdodCBzdHlsZSB0byB0aGUgbGFzdCBjaGlsZCBlbGVtZW50IHdoaWNoIHdpbGwgcmVzb2x2ZSB0aGUgaXNzdWVcbiAgICogb2YgbGFzdCBpdGVtIGdldHMgY3V0b2ZmLlxuICAgKi9cbiAgcHJpdmF0ZSBhZGp1c3RNYXJnaW5Ub0xhc3RDaGlsZCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fY2hpbGRyZW4gJiYgdGhpcy5oaWRlU2Nyb2xsYmFyKSB7XG4gICAgICBjb25zdCBsYXN0SXRlbSA9IHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddW3RoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aCAtIDFdLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICBpZiAodGhpcy53cmFwcGVyICYmIHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUobGFzdEl0ZW0sICdtYXJnaW4tcmlnaHQnLCB0aGlzLnNjcm9sbGJhcldpZHRoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGxhc3RJdGVtLCAnbWFyZ2luLXJpZ2h0JywgMCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0=